<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="layout :: content">
<section>
  <h1>Check Out</h1>
  <div class="cart-grid">
    <div>
      <h2>Items</h2>
      <table>
        <thead><tr><th>Item</th><th>Qty</th><th>Price</th><th>Total</th><th></th></tr></thead>
        <tbody>
        <tr th:each="i : ${cart.items}">
          <td th:text="${i.title} + ' (' + ${i.itemType} + ')'">Title</td>
          <td th:text="${i.qty}">1</td>
          <td th:text="'₱' + ${i.price}">0</td>
          <td th:text="'₱' + ${i.price.multiply(T(java.math.BigDecimal).valueOf(i.qty))}">0</td>
          <td>
            <form th:action="@{/cart/remove}" method="post">
              <input type="hidden" name="type" th:value="${i.itemType}"/>
              <input type="hidden" name="id" th:value="${i.refId}"/>
              <button type="submit">Remove</button>
            </form>
          </td>
        </tr>
        </tbody>
      </table>
      <h3>Total: <span th:text="'₱' + ${cart.total()}">0</span></h3>
    </div>

    <div>
      <h2>Purchase</h2>
      <form th:action="@{/purchase}" method="post" th:object="${checkoutForm}">
        <label>Name</label>
        <input type="text" th:field="*{name}" required>
        <label>Email</label>
        <input type="email" th:field="*{email}" required>
        <label>Address</label>
        <input type="text" th:field="*{address}" required>
        <label>Payment Method</label>
        <select th:field="*{paymentMethod}" required>
          <option value="">Choose...</option>
          <option value="cash">Cash</option>
          <option value="gcash">GCash</option>
          <option value="card">Card</option>
        </select>
        <label>Phone</label>
        <input type="text" th:field="*{phone}" required>
        <button type="submit" th:disabled="${cart.empty}">Purchase</button>
      </form>
    </div>
  </div>
</section>
</html>
